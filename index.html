<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Äua Vá»‹t ğŸ¦†</title>
    <link rel="stylesheet" href="style.css?v=25">
</head>
<body>
    <div class="container">
        <h1>ğŸ¦† GAME ÄUA Vá»ŠT ğŸ¦†</h1>
        
        <!-- Statistics Panel -->
        <!-- CÃ i Ä‘áº·t game -->
        <div class="settings-panel" id="settingsPanel">
            <h2>CÃ i Äáº·t Cuá»™c Äua</h2>
            <div class="input-group">
                <label for="duckCount">Sá»‘ lÆ°á»£ng vá»‹t:</label>
                <input type="number" id="duckCount" min="10" max="1000" value="300">
            </div>
            <div class="input-group">
                <label for="raceDuration">Thá»i gian Ä‘ua (giÃ¢y):</label>
                <input type="number" id="raceDuration" min="5" max="300" value="10">
            </div>
            <div class="input-group">
                <label for="duckNamesFile">File danh sÃ¡ch (CSV/Excel):</label>
                <input type="file" id="duckNamesFile" accept=".csv,.xlsx" onchange="game.loadDuckNames(event)">
                <small style="color: #888;">Táº£i file CSV vá»›i cá»™t STT vÃ  Há» tÃªn</small>
            </div>
            <div class="input-group">
                <label for="iconTheme">Chá»§ Ä‘á» icon:</label>
                <select id="iconTheme" onchange="game.changeIconTheme()">
                    <option value="output_1">Chá»§ Ä‘á» 1</option>
                    <option value="output_2">Chá»§ Ä‘á» 2</option>
                </select>
                <small style="color: #888;" id="iconCount">0 icon</small>
            </div>
            <div class="input-group">
                <label for="soundToggle">
                    <input type="checkbox" id="soundToggle" checked> Báº­t Ã¢m thanh
                </label>
            </div>
            <button class="btn btn-primary" onclick="game.startRace()">Báº¯t Äáº§u Äua</button>
        </div>

        <!-- ThÃ´ng tin Ä‘ua -->
        <div class="race-info hidden" id="raceInfo">
            <div class="info-item">
                <span class="label">Tráº­n Ä‘ua:</span>
                <span id="raceNumber" class="value">#1</span>
            </div>
            <div class="info-item">
                <span class="label">Thá»i gian cÃ²n láº¡i:</span>
                <span id="timeLeft" class="value">30s</span>
            </div>
            <div class="info-item">
                <span class="label">Tráº¡ng thÃ¡i:</span>
                <span id="raceStatus" class="value">Chá» báº¯t Ä‘áº§u</span>
            </div>
        </div>

        <!-- Control Panel -->
        <div class="control-panel hidden" id="controlPanel">
            <button class="btn btn-small" onclick="game.toggleFullscreen()" id="fullscreenBtn">ğŸ”² Fullscreen</button>
            <button class="btn btn-small" onclick="game.pauseRace()" id="pauseBtn">â¸ Táº¡m dá»«ng</button>
            <button class="btn btn-small" onclick="game.resumeRace()" id="resumeBtn" disabled>â–¶ Tiáº¿p tá»¥c</button>
            <button class="btn btn-small" onclick="game.toggleReplay()" id="replayBtn" disabled>ğŸ”„ Replay</button>
            <button class="btn btn-primary hidden" onclick="game.continueRace()" id="continueBtn">ğŸ¯ Tiáº¿p Tá»¥c Giáº£i Tiáº¿p Theo</button>
        </div>

        <!-- Main Content Area -->
        <div class="race-container">
            <!-- Hybrid Approach: DOM-based racing track -->
            <div class="race-track hidden" id="raceTrack">
                <!-- Big Timer Display -->
                <div class="big-timer hidden" id="bigTimer">
                    <div class="timer-display">00:00:00</div>
                </div>
                <div class="bank-top" id="bankTop"></div>
                <div class="race-river" id="raceRiver">
                    <div class="water-flow"></div>
                    <div class="water-ripples"></div>
                    <div class="fish-layer" id="fishLayer">
                        <div class="fish fish-1">ğŸŸ</div>
                        <div class="fish fish-2">ğŸ </div>
                        <div class="fish fish-3">ğŸ¡</div>
                        <div class="fish fish-4">ğŸŸ</div>
                        <div class="fish fish-5">ğŸ </div>
                    </div>
                    <!-- Ducks will be added here dynamically -->
                </div>
                <div class="bank-bot" id="bankBot">
                    <button class="btn btn-primary hidden" onclick="game.continueRace()" id="continueBankBtn" style="position: absolute; left: 50%; transform: translateX(-50%); bottom: 20px; z-index: 1000;">ğŸ¯ Tiáº¿p Tá»¥c Giáº£i Tiáº¿p Theo</button>
                </div>
                <div class="finish-line hidden" id="finishLine">FINISH</div>
            </div>

            <!-- Mini Map -->
            <div class="minimap hidden" id="minimap">
                <h4>ğŸ“ Mini Map</h4>
                <div class="minimap-track" id="minimapTrack">
                    <div class="minimap-start"></div>
                    <div class="minimap-finish"></div>
                    <div class="minimap-ducks" id="minimapDucks"></div>
                    <div class="minimap-viewport" id="minimapViewport"></div>
                </div>
            </div>
        </div>

        <!-- Báº£ng xáº¿p háº¡ng -->
        <div class="history-win" id="historyWin">
            <h3>ğŸ† Lá»‹ch Sá»­ Chiáº¿n Tháº¯ng</h3>
            <div id="historyWinList"></div>
            <button class="btn btn-small" onclick="game.resetHistory()" style="margin-top: 10px; width: 100%;">ğŸ”„ ChÆ¡i Láº¡i (XÃ³a Lá»‹ch Sá»­)</button>
        </div>

        <!-- Highlights Panel -->
        <!-- <div class="highlights-panel hidden" id="highlightsPanel">
            <h3>âš¡ Highlights</h3>
            <div id="highlightsList"></div>
        </div> -->

        <!-- Káº¿t quáº£ -->
        <div class="result-panel hidden" id="resultPanel">
            <h2 id="resultTitle">Káº¿t Quáº£</h2>
            <div id="resultMessage"></div>
            <div class="result-actions">
                <button class="btn btn-primary" onclick="game.fullReset()">ğŸ”„ ChÆ¡i Láº¡i</button>
                <button class="btn btn-secondary" onclick="game.viewHistory()">ğŸ“œ Xem Lá»‹ch Sá»­</button>
            </div>
        </div>

        <!-- Race History -->
        <div class="history-panel hidden" id="historyPanel">
            <h2>ğŸ“Š Lá»‹ch Sá»­ CÃ¡c Tráº­n Äua</h2>
            <div id="historyList"></div>
            <button class="btn btn-primary" onclick="game.closeHistory()">ÄÃ³ng</button>
        </div>
    </div>

    <!-- Victory Popup (outside container for max z-index) -->
    <div class="victory-popup hidden" id="victoryPopup">
        <div class="victory-overlay" onclick="game.closeVictoryPopup()"></div>
        <div class="victory-content">
            <div class="victory-header">
                <h1>ğŸ‰ CHIáº¾N THáº®NG! ğŸ‰</h1>
            </div>
            <div class="victory-body">
                <div class="winner-icon" id="winnerIcon"></div>
                <h2 class="winner-name" id="winnerName">Winner Name</h2>
                <div class="winner-stats" id="winnerStats"></div>
            </div>
            <div class="victory-footer">
                <button class="btn btn-primary" onclick="game.continueRace()">ğŸ¯ Tiáº¿p Tá»¥c (Giáº£i Tiáº¿p Theo)</button>
                <button class="btn btn-secondary" onclick="game.showWinnersPanel(); game.closeVictoryPopup()">ğŸ“‹ Xem Káº¿t Quáº£</button>
            </div>
        </div>
    </div>

    <script src="game.js?v=22"></script>
    <script>
        // Debug: Check if game object exists
        window.addEventListener('load', function() {
            console.log('Page loaded');
            console.log('Game object exists:', typeof game !== 'undefined');
            if (typeof game !== 'undefined') {
                console.log('Game initialized successfully');
            } else {
                console.error('Game object not found! Check game.js for errors.');
            }
        });
    </script>
</body>
</html>
